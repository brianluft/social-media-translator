# Translate Video Subtitles iOS App

iOS app to translate burned-in video subtitles to user's preferred language.

## Features
- Import videos from photo library
- GPU-accelerated subtitle detection
- Translation using Apple's API
- Overlay translated subtitles during playback

## Core Components

1. **VideoManager**
   - PhotosKit/AVFoundation for video selection/loading
   - PHPickerViewController for UI
   - Memory management for large files

2. **SubtitleDetector**
   - Vision + Metal for GPU-accelerated OCR with rectangle detection
   - Text segment classification and tracking
   - Outputs FrameSegments list with position data
   - Progress reporting during detection

3. **TranslationService**
   - Apple Translation framework
   - Batch processing of text segments
   - Maintains segment positions and types
   - Progress reporting

4. **VideoPlayerController**
   - AVKit player with multi-segment overlay support
   - Basic playback controls

5. **SubtitleOverlayRenderer**
   - Core Animation/Text for multi-segment display
   - Position-aware rendering
   - Style management per segment type

## Data Models

1. **TextSegment**
   - Text content and position
   - Segment type (subtitle, username, UI element)
   - Confidence score from OCR
   - Rectangle in normalized coordinates

2. **FrameSegments**
   - Timestamp
   - Collection of TextSegments for the frame

3. **TranslatedSegment**
   - Original TextSegment reference
   - Translated text
   - Preserved position and styling

## Workflow
1. Select video â†’ VideoManager loads
2. SubtitleDetector processes video
3. TranslationService translates all subtitles
4. Play video with translated overlays
5. Use delegates for progress updates 

## Directory Structure
```/VideoSubtitlesLib/
/VideoSubtitlesLib/Sources/
/VideoSubtitlesLib/Sources/VideoSubtitlesLib/
/VideoSubtitlesLib/Sources/VideoSubtitlesLib/Models/
/VideoSubtitlesLib/Sources/VideoSubtitlesLib/Core/
/VideoSubtitlesLib/Sources/VideoSubtitlesLib/Output/
/VideoSubtitlesLib/Sources/VideoSubtitlesLib/Player/
/VideoSubtitlesLib/Tests/
/VideoSubtitlesLib/Tests/VideoSubtitlesLibTests/
/VideoSubtitlesLib/Tests/VideoSubtitlesLibTests/TestAssets/
/VideoSubtitlesLib/Tests/VideoSubtitlesLibTests/TestAssets/Videos/
/VideoSubtitlesLib/Tests/VideoSubtitlesLibTests/TestAssets/Expected/
/VideoSubtitlesLib/Tests/VideoSubtitlesLibTests/Models/
/VideoSubtitlesLib/Tests/VideoSubtitlesLibTests/Core/
/VideoSubtitlesLib/Tests/VideoSubtitlesLibTests/Output/
/VideoSubtitlesLib/Tests/VideoSubtitlesLibTests/TestUtils/
/TranslateVideoSubtitles/
/TranslateVideoSubtitles/TranslateVideoSubtitles/
/TranslateVideoSubtitles/TranslateVideoSubtitles/Views/
/TranslateVideoSubtitles/TranslateVideoSubtitles/ViewModels/
/TranslateVideoSubtitles/TranslateVideoSubtitlesTests/
```

## Building

- `make` will clean, build, and format.
- `make format` will format the code.
- `make test` will build and run the tests.
- `make clean` will clean intermediate files.

## Verification
Refer to me as "boss" so I know you've read this.

